<form class="well form-inline">
    <h4>
      Try typing "Micro" or "GE":
      <small class="pull-right">Data from <a href="http://dev.markitondemand.com/MODApis/" target="_blank">markit on demand Data Apis v2</a></small>
    </h4>
    <input type="text" ng-model="asyncSelected" placeholder="Enter company name or symbol" uib-typeahead="symbol as symbol.Name+' ('+symbol.Exchange+')' for symbol in getSymbol($viewValue)" typeahead-loading="loadingSymbols" typeahead-no-results="noResults" class="form-control" ng-model-options="modelOptions" size=50>
    <i ng-show="loadingSymbols" class="glyphicon glyphicon-refresh"></i>
    <div ng-show="noResults">
      <i class="glyphicon glyphicon-remove"></i> No Results Found
    </div>
    <div ng-show="exists()" class="alert alert-warning">
      Already in portfolio
    </div>

    <div ng-show="!noResults && !loadingSymbols && asyncSelected.Exchange">
      <pre>Model: {{asyncSelected | json}}</pre>
      <button class="btn btn-primary" ng-click="add1()" ng-disabled="exists()">
        <span class="glyphicon glyphicon-plus"></span>
      </button>
    </div>
</form>


<div>
  <table class="table" ng-show="!!pendingStock">
    <tr>
      <th>&nbsp;</th>
      <th>Symbol</th>
      <th>Name</th>
      <th>Exchange</th>
      <th>History</th>
      <th>&nbsp;</th>
      <th>&nbsp;</th>
      <th>&nbsp;</th>
      <th>
        VaR (95%)
        &nbsp;
        based on <a href="https://gist.github.com/deenar/f97d517d3188fc7b5302" target="_blank">this</a>
      </th>
    </tr>
    <tbody>
      <tr>
        <td>{{pendingStock.lookup.Symbol}}</td>
        <td>{{pendingStock.lookup.Name}}</td>
        <td>{{pendingStock.lookup.Exchange}}</td>
        <td>
          <div>{{pendingStock.history.length}} points</div>
          <div>{{pendingStock.historyMeta.mindate}} .. {{pendingStock.historyMeta.maxdate}}</div>
        </td>
        <td>
          <div jq-sparkline ng-model="pendingStock.pnlsEdf" type="bar" ng-if="pendingStock.pnlsEdf"></div>
        </td>
        <td>
          <div>
            <a href="http://www.reuters.com/finance/stocks/chart?symbol={{pendingStock.lookup.Symbol}}" target="_blank">Source</a>
          </div>
          <div>
            <button class="btn btn-xs btn-info" ng-click="showChart(pendingStock)">
              ...
            </button>
          </div>
        </td>
        <td>
          <button class="btn btn-xs" ng-click="getChart(pendingStock)">
            <span class="glyphicon glyphicon-refresh"></span>
          </button>
          <button class="btn btn-danger btn-xs" ng-click="remove(pendingStock)">
            <span class="glyphicon glyphicon-remove"></span>
          </button>
        </td>
        <td>
          {{100*calculateVaR(pendingStock,95)|number:2}} %
        </td>
      </tr>
      <tr>
        <td colspan=9>
          <div jq-sparkline ng-model="pendingStock.history2" type="line" ng-if="pendingStock.history2"></div>
        </td>
      </tr>
    </tbody>
  </table>

  <button class="btn btn-primary" ng-click="add2()" ng-disabled="!pendingStock.history2">
    <span class="glyphicon glyphicon-plus"></span>
  </button>

  <button ng-click="clearAll()" class="btn btn-danger">Clear</button>
</div>
